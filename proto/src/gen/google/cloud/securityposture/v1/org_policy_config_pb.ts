// Copyright 2024 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// @generated by protoc-gen-es v2.1.0 with parameter "target=ts"
// @generated from file google/cloud/securityposture/v1/org_policy_config.proto (package google.cloud.securityposture.v1, syntax proto3)
/* eslint-disable */

import type { GenEnum, GenFile, GenMessage } from "@bufbuild/protobuf/codegenv1";
import { enumDesc, fileDesc, messageDesc } from "@bufbuild/protobuf/codegenv1";
import { file_google_api_field_behavior } from "../../../api/field_behavior_pb";
import type { Timestamp } from "@bufbuild/protobuf/wkt";
import { file_google_protobuf_timestamp } from "@bufbuild/protobuf/wkt";
import type { Expr } from "../../../type/expr_pb";
import { file_google_type_expr } from "../../../type/expr_pb";
import type { Message } from "@bufbuild/protobuf";

/**
 * Describes the file google/cloud/securityposture/v1/org_policy_config.proto.
 */
export const file_google_cloud_securityposture_v1_org_policy_config: GenFile = /*@__PURE__*/
  fileDesc("Cjdnb29nbGUvY2xvdWQvc2VjdXJpdHlwb3N0dXJlL3YxL29yZ19wb2xpY3lfY29uZmlnLnByb3RvEh9nb29nbGUuY2xvdWQuc2VjdXJpdHlwb3N0dXJlLnYxIoECCgpQb2xpY3lSdWxlEkoKBnZhbHVlcxgBIAEoCzI4Lmdvb2dsZS5jbG91ZC5zZWN1cml0eXBvc3R1cmUudjEuUG9saWN5UnVsZS5TdHJpbmdWYWx1ZXNIABITCglhbGxvd19hbGwYAiABKAhIABISCghkZW55X2FsbBgDIAEoCEgAEhEKB2VuZm9yY2UYBCABKAhIABIkCgljb25kaXRpb24YBSABKAsyES5nb29nbGUudHlwZS5FeHByGj0KDFN0cmluZ1ZhbHVlcxIWCg5hbGxvd2VkX3ZhbHVlcxgBIAMoCRIVCg1kZW5pZWRfdmFsdWVzGAIgAygJQgYKBGtpbmQi7AMKEEN1c3RvbUNvbnN0cmFpbnQSEQoEbmFtZRgBIAEoCUID4EEFEhsKDnJlc291cmNlX3R5cGVzGAIgAygJQgPgQQUSUgoMbWV0aG9kX3R5cGVzGAMgAygOMjwuZ29vZ2xlLmNsb3VkLnNlY3VyaXR5cG9zdHVyZS52MS5DdXN0b21Db25zdHJhaW50Lk1ldGhvZFR5cGUSEQoJY29uZGl0aW9uGAQgASgJElEKC2FjdGlvbl90eXBlGAUgASgOMjwuZ29vZ2xlLmNsb3VkLnNlY3VyaXR5cG9zdHVyZS52MS5DdXN0b21Db25zdHJhaW50LkFjdGlvblR5cGUSFAoMZGlzcGxheV9uYW1lGAYgASgJEhMKC2Rlc2NyaXB0aW9uGAcgASgJEjQKC3VwZGF0ZV90aW1lGAggASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcEID4EEDIk0KCk1ldGhvZFR5cGUSGwoXTUVUSE9EX1RZUEVfVU5TUEVDSUZJRUQQABIKCgZDUkVBVEUQARIKCgZVUERBVEUQAhIKCgZERUxFVEUQAyI+CgpBY3Rpb25UeXBlEhsKF0FDVElPTl9UWVBFX1VOU1BFQ0lGSUVEEAASCQoFQUxMT1cQARIICgRERU5ZEAJCjAEKI2NvbS5nb29nbGUuY2xvdWQuc2VjdXJpdHlwb3N0dXJlLnYxQhRPcmdQb2xpY3lDb25maWdQcm90b1ABWk1jbG91ZC5nb29nbGUuY29tL2dvL3NlY3VyaXR5cG9zdHVyZS9hcGl2MS9zZWN1cml0eXBvc3R1cmVwYjtzZWN1cml0eXBvc3R1cmVwYmIGcHJvdG8z", [file_google_api_field_behavior, file_google_protobuf_timestamp, file_google_type_expr]);

/**
 * A rule used to express this policy.
 *
 * @generated from message google.cloud.securityposture.v1.PolicyRule
 */
export type PolicyRule = Message<"google.cloud.securityposture.v1.PolicyRule"> & {
  /**
   * @generated from oneof google.cloud.securityposture.v1.PolicyRule.kind
   */
  kind: {
    /**
     * List of values to be used for this policy rule. This field can be set
     * only in policies for list constraints.
     *
     * @generated from field: google.cloud.securityposture.v1.PolicyRule.StringValues values = 1;
     */
    value: PolicyRule_StringValues;
    case: "values";
  } | {
    /**
     * Setting this to true means that all values are allowed. This field can
     * be set only in policies for list constraints.
     *
     * @generated from field: bool allow_all = 2;
     */
    value: boolean;
    case: "allowAll";
  } | {
    /**
     * Setting this to true means that all values are denied. This field can
     * be set only in policies for list constraints.
     *
     * @generated from field: bool deny_all = 3;
     */
    value: boolean;
    case: "denyAll";
  } | {
    /**
     * If `true`, then the policy is enforced. If `false`, then any
     * configuration is acceptable.
     * This field can be set only in policies for boolean constraints.
     *
     * @generated from field: bool enforce = 4;
     */
    value: boolean;
    case: "enforce";
  } | { case: undefined; value?: undefined };

  /**
   * A condition which determines whether this rule is used
   * in the evaluation of the policy. When set, the `expression` field in
   * the `Expr' must include from 1 to 10 subexpressions, joined by the "||"
   * or "&&" operators. Each subexpression must be of the form
   * "resource.matchTag('<ORG_ID>/tag_key_short_name,
   * 'tag_value_short_name')" or "resource.matchTagId('tagKeys/key_id',
   * 'tagValues/value_id')" where key_name and value_name are the resource
   * names for Label Keys and Values. These names are available from the Tag
   * Manager Service. An example expression is:
   * "resource.matchTag('123456789/environment,
   * 'prod')" or "resource.matchTagId('tagKeys/123',
   * 'tagValues/456')".
   *
   * @generated from field: google.type.Expr condition = 5;
   */
  condition?: Expr;
};

/**
 * Describes the message google.cloud.securityposture.v1.PolicyRule.
 * Use `create(PolicyRuleSchema)` to create a new message.
 */
export const PolicyRuleSchema: GenMessage<PolicyRule> = /*@__PURE__*/
  messageDesc(file_google_cloud_securityposture_v1_org_policy_config, 0);

/**
 * A message that holds specific allowed and denied values.
 * This message can define specific values and subtrees of the Resource
 * Manager resource hierarchy (`Organizations`, `Folders`, `Projects`) that
 * are allowed or denied. This is achieved by using the `under:` and
 * optional `is:` prefixes.
 * The `under:` prefix is used to denote resource subtree values.
 * The `is:` prefix is used to denote specific values, and is required only
 * if the value contains a ":". Values prefixed with "is:" are treated the
 * same as values with no prefix.
 * Ancestry subtrees must be in one of the following formats:
 *
 * - `projects/<project-id>` (for example, `projects/tokyo-rain-123`)
 * - `folders/<folder-id>` (for example, `folders/1234`)
 * - `organizations/<organization-id>` (for example, `organizations/1234`)
 *
 * The `supports_under` field of the associated `Constraint`  defines
 * whether ancestry prefixes can be used.
 *
 * @generated from message google.cloud.securityposture.v1.PolicyRule.StringValues
 */
export type PolicyRule_StringValues = Message<"google.cloud.securityposture.v1.PolicyRule.StringValues"> & {
  /**
   * List of values allowed at this resource.
   *
   * @generated from field: repeated string allowed_values = 1;
   */
  allowedValues: string[];

  /**
   * List of values denied at this resource.
   *
   * @generated from field: repeated string denied_values = 2;
   */
  deniedValues: string[];
};

/**
 * Describes the message google.cloud.securityposture.v1.PolicyRule.StringValues.
 * Use `create(PolicyRule_StringValuesSchema)` to create a new message.
 */
export const PolicyRule_StringValuesSchema: GenMessage<PolicyRule_StringValues> = /*@__PURE__*/
  messageDesc(file_google_cloud_securityposture_v1_org_policy_config, 0, 0);

/**
 * A custom constraint defined by customers which can *only* be applied to the
 * given resource types and organization.
 *
 * By creating a custom constraint, customers can apply policies of this
 * custom constraint. *Creating a custom constraint itself does NOT apply any
 * policy enforcement*.
 *
 * @generated from message google.cloud.securityposture.v1.CustomConstraint
 */
export type CustomConstraint = Message<"google.cloud.securityposture.v1.CustomConstraint"> & {
  /**
   * Immutable. Name of the constraint. This is unique within the organization.
   * Format of the name should be
   *
   * -
   * `organizations/{organization_id}/customConstraints/{custom_constraint_id}`
   *
   * Example: `organizations/123/customConstraints/custom.createOnlyE2TypeVms`
   *
   * The max length is 70 characters and the minimum length is 1. Note that the
   * prefix `organizations/{organization_id}/customConstraints/` is not counted.
   *
   * @generated from field: string name = 1;
   */
  name: string;

  /**
   * Immutable. The resource instance type on which this policy applies. Format
   * will be of the form : `<canonical service name>/<type>` Example:
   *
   *  - `compute.googleapis.com/Instance`.
   *
   * @generated from field: repeated string resource_types = 2;
   */
  resourceTypes: string[];

  /**
   * All the operations being applied for this constraint.
   *
   * @generated from field: repeated google.cloud.securityposture.v1.CustomConstraint.MethodType method_types = 3;
   */
  methodTypes: CustomConstraint_MethodType[];

  /**
   * Org policy condition/expression. For example:
   * `resource.instanceName.matches("[production|test]_.*_(\d)+")` or,
   * `resource.management.auto_upgrade == true`
   *
   * The max length of the condition is 1000 characters.
   *
   * @generated from field: string condition = 4;
   */
  condition: string;

  /**
   * Allow or deny type.
   *
   * @generated from field: google.cloud.securityposture.v1.CustomConstraint.ActionType action_type = 5;
   */
  actionType: CustomConstraint_ActionType;

  /**
   * One line display name for the UI.
   * The max length of the display_name is 200 characters.
   *
   * @generated from field: string display_name = 6;
   */
  displayName: string;

  /**
   * Detailed information about this custom policy constraint.
   * The max length of the description is 2000 characters.
   *
   * @generated from field: string description = 7;
   */
  description: string;

  /**
   * Output only. The last time this custom constraint was updated. This
   * represents the last time that the `CreateCustomConstraint` or
   * `UpdateCustomConstraint` RPC was called
   *
   * @generated from field: google.protobuf.Timestamp update_time = 8;
   */
  updateTime?: Timestamp;
};

/**
 * Describes the message google.cloud.securityposture.v1.CustomConstraint.
 * Use `create(CustomConstraintSchema)` to create a new message.
 */
export const CustomConstraintSchema: GenMessage<CustomConstraint> = /*@__PURE__*/
  messageDesc(file_google_cloud_securityposture_v1_org_policy_config, 1);

/**
 * The operation for which this constraint will be applied. To apply this
 * constraint only when creating new VMs, the `method_types` should be
 * `CREATE` only. To apply this constraint when creating or deleting
 * VMs, the `method_types` should be `CREATE` and `DELETE`.
 *
 * `UPDATE` only custom constraints are not supported. Use `CREATE` or
 * `CREATE, UPDATE`.
 *
 * @generated from enum google.cloud.securityposture.v1.CustomConstraint.MethodType
 */
export enum CustomConstraint_MethodType {
  /**
   * Unspecified. Results in an error.
   *
   * @generated from enum value: METHOD_TYPE_UNSPECIFIED = 0;
   */
  METHOD_TYPE_UNSPECIFIED = 0,

  /**
   * Constraint applied when creating the resource.
   *
   * @generated from enum value: CREATE = 1;
   */
  CREATE = 1,

  /**
   * Constraint applied when updating the resource.
   *
   * @generated from enum value: UPDATE = 2;
   */
  UPDATE = 2,

  /**
   * Constraint applied when deleting the resource.
   * Not supported yet.
   *
   * @generated from enum value: DELETE = 3;
   */
  DELETE = 3,
}

/**
 * Describes the enum google.cloud.securityposture.v1.CustomConstraint.MethodType.
 */
export const CustomConstraint_MethodTypeSchema: GenEnum<CustomConstraint_MethodType> = /*@__PURE__*/
  enumDesc(file_google_cloud_securityposture_v1_org_policy_config, 1, 0);

/**
 * Allow or deny type.
 *
 * @generated from enum google.cloud.securityposture.v1.CustomConstraint.ActionType
 */
export enum CustomConstraint_ActionType {
  /**
   * Unspecified. Results in an error.
   *
   * @generated from enum value: ACTION_TYPE_UNSPECIFIED = 0;
   */
  ACTION_TYPE_UNSPECIFIED = 0,

  /**
   * Allowed action type.
   *
   * @generated from enum value: ALLOW = 1;
   */
  ALLOW = 1,

  /**
   * Deny action type.
   *
   * @generated from enum value: DENY = 2;
   */
  DENY = 2,
}

/**
 * Describes the enum google.cloud.securityposture.v1.CustomConstraint.ActionType.
 */
export const CustomConstraint_ActionTypeSchema: GenEnum<CustomConstraint_ActionType> = /*@__PURE__*/
  enumDesc(file_google_cloud_securityposture_v1_org_policy_config, 1, 1);

